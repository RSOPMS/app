{{ define "projectsPage" }}
  {{ template "top" }}
  <h1>Projects</h1>
  <div hx-get="{{ urlPrefixIssue }}/api/projects/table"
       hx-trigger="load"
       hx-swap="outerHTML">
  </div>
  {{ template "bot" }}
{{ end }}

{{ define "projectPage" }}
  {{ template "top" }}
  <h1>{{ .Title }}</h1>
  <h2>Issues</h2>
  <div hx-get="{{ urlPrefixIssue }}/api/projects/{{ .Id }}/issues/table"
       hx-trigger="load"
       hx-swap="outerHTML">
  </div>

  <!-- Add New Issue Button -->
  <button onclick="document.getElementById('new-issue-dialog').showModal()">Add New Issue</button>

  <!-- New Issue Dialog -->
  <dialog id="new-issue-dialog">
    <form hx-post="{{ urlPrefixIssue }}/api/issues"
        hx-trigger="submit"
        hx-swap="beforebegin"
        hx-target="#issuesTableBody">
      <h3>Create New Issue</h3>

      <label for="title">Title:</label>
      <input type="text" id="title" name="title" required><br>

      <label for="description">Description:</label>
      <textarea id="description" name="description" required></textarea><br>

      <label for="projectId">Project ID:</label>
      <input type="number" id="projectId" name="projectId" value="{{ .Id }}" readonly><br>

      <div hx-get="{{ urlPrefixIssue }}/api/status/form"
          hx-trigger="revealed"
          hx-target="this"
          hx-swap="innerHTML">
      </div>

      <div hx-get="{{ urlPrefixIssue }}/api/priority/form"
          hx-trigger="revealed"
          hx-target="this"
          hx-swap="innerHTML">
      </div>

      <div hx-get="{{ urlPrefixIssue }}/api/branch/form"
          hx-trigger="revealed"
          hx-target="this"
          hx-swap="innerHTML">
      </div>

      <button type="submit" onclick="document.getElementById('new-issue-dialog').close()">Create Issue</button>
      <button type="button" onclick="document.getElementById('new-issue-dialog').close()">Cancel</button>
    </form>
  </dialog>
  {{ template "bot" }}
{{ end }}
